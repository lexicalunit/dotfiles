#! .profile_invision

studio() {
cat <<EOF

╭━━━╮╭╮╱╱╱╱╱╭╮
┃╭━╮┣╯╰╮╱╱╱╱┃┃
┃╰━━╋╮╭╋╮╭┳━╯┣┳━━╮
╰━━╮┃┃┃┃┃┃┃╭╮┣┫╭╮┃
┃╰━╯┃┃╰┫╰╯┃╰╯┃┃╰╯┣╮
╰━━━╯╰━┻━━┻━━┻┻━━┻╯

EOF
}

invision() {
    echo $'\e[38;5;203m\e[48;5;21m''                                                                       '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''                                                                       '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''                                                              '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''              .%@@@/                                          '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''             &@@@@@@@                                         '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''            .@@@@@@@@,                                        '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''             /@@@@@@(                                         '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''                ,,.                                           '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''                                                              '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''        &&&&&&&&&&&&   &&&&&&&&&&&    (@@@@@%.                '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''       #@@@@@@@@@@@#  (@@@@@@@@@@/ (@@@@@@@@@@@(              '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''       @@@@@@@@@@@@   @@@@@@@@@@@*@@@@@@@@@@@@@@/             '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''           (@@@@@@#       *@@@@@@@@,    ,@@@@@@@@             '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''           @@@@@@@        @@@@@@@(       ,@@@@@@@             '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''          #@@@@@@/       (@@@@@@#        *@@@@@@#             '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''          @@@@@@@        @@@@@@@         @@@@@@@.             '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''         #@@@@@@/       (@@@@@@#        /@@@@@@#              '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''         @@@@@@@        @@@@@@@         @@@@@@@               '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''        #@@@@@@,       &@@@@@@/        %@@@@@@*   ..          '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''        @@@@@@@      ,@@@@@@@@         @@@@@@@    @@@.        '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''        @@@@@@@,  .(@@@@@@@@@/         @@@@@@@  *@@@*         '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''        (@@@@@@@@@@@@.@@@@@@@          #@@@@@@@@@@@(          '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''          %@@@@@@@#  #@@@@@@*            %@@@@@@@*            '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''    '$'\e[48;5;231m''                                                              '$'\e[48;5;21m''     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''                                                                       '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''                   Design better products, faster.                     '$'\e[0m'
    echo $'\e[38;5;203m\e[48;5;21m''                                                                       '$'\e[0m'
}

# I typically use a conda environment for anything python related I want to install globally.
# However for InVision projects we expect to use the system standard Python 2.7.
_exit_conda_for_invision_projects() {
    if [[ "$PWD" = *"/invision/"* && "$OLDPWD" != *"/invision/"* ]]; then
        exitconda
    elif [[ "$PWD" != *"/invision/"* && "$OLDPWD" = *"/invision/"* ]]; then
        enterconda
    fi
}

if [[ -n "$ZSH_VERSION" ]]; then
    if [[ ! "${chpwd_functions[*]}" == *_exit_conda_for_invision_projects* ]]; then
        chpwd_functions+=("_exit_conda_for_invision_projects")
    fi
fi

_enter_nvm_for_invision_projects() {
    if [[ "$PWD" = *"/invision/"* && "$OLDPWD" != *"/invision/"* ]]; then
        nvm use v10 >/dev/null
        exitconda
    elif [[ "$PWD" != *"/invision/"* && "$OLDPWD" = *"/invision/"* ]]; then
        nvm use system >/dev/null
        enterconda
    fi
}

if [[ -n "$ZSH_VERSION" ]]; then
    if [[ ! "${chpwd_functions[*]}" == *_enter_nvm_for_invision_projects* ]]; then
        chpwd_functions+=("_enter_nvm_for_invision_projects")
    fi
fi

_enter_go_path_for_invision_projects() {
    if [[ "$PWD" = *"/invision/"* && "$OLDPWD" != *"/invision/"* ]]; then
        # gotta strip out things setup by .profile...
        test -d "$GOPATH/bin" && PATH="$(echo "$PATH" | sed "s@$GOPATH/bin@@g;s@::*@:@g;s@:\$@@g;s@^:@@g")"
        GOPATH="/usr/local/lib/invision/gopath"
        if [[ ! -d "$GOPATH" ]]; then
            mkdir -p "$GOPATH/bin"
        fi
        test -d "$GOPATH/bin" && PATH="$PATH:$_"
        export PATH GOPATH
    elif [[ "$PWD" != *"/invision/"* && "$OLDPWD" = *"/invision/"* ]]; then
        # reverse the above...
        test -d "$GOPATH/bin" && PATH="$(echo "$PATH" | sed "s@$GOPATH/bin@@g;s@::*@:@g;s@:\$@@g;s@^:@@g")"
        GOPATH="/usr/local/lib/gopath"
        if [[ ! -d "$GOPATH" ]]; then
            mkdir -p "$GOPATH/bin"
        fi
        test -d "$GOPATH/bin" && PATH="$PATH:$_"
        export PATH GOPATH
    fi
}

if [[ -n "$ZSH_VERSION" ]]; then
    if [[ ! "${chpwd_functions[*]}" == *_enter_go_path_for_invision_projects* ]]; then
        chpwd_functions+=("_enter_go_path_for_invision_projects")
    fi
fi

# AWS and Github tokens
AWS_ACCESS_KEY_ID="$(security find-generic-password -a "$USER" -s invision_aws_access_key -w)"
AWS_SECRET_ACCESS_KEY="$(security find-generic-password -a "$USER" -s invision_aws_secret_access_key -w)"
GITHUB_TOKEN="$(security find-generic-password -a "$USER" -s invision_github_token -w)"
export AWS_ACCESS_KEY_ID AWS_SECRET_ACCESS_KEY GITHUB_TOKEN

# Applications
export USER_NAMESPACE="$USER-invisionapp"
export TRAPEZOID_LOGGER_PORT=80
export STUDIO_ENABLE_PLATFORM_LOGS=true
