# .profile_montecarlo

mc() {
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m         (&@@&        &@@&        %@@@@             \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m         (@@@@@      @@@@@     @@@@#  @@@@(         \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m         (@@ @@@    @@@ @@   (@@                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m         (@@  @@@  @@@  @@   @@@                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m         (@@   @@&&@@   @@   (@@                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m         (@@    @@@@    @@     @@@@#  @@@@(         \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m         (&&     &&     &&        %@@@@             \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
    echo $'\e[48;5;75m\e[1m\e[38;5;231m                                                    \e[0m'
}

_enter_virtualenv_dir() {
    local venv_dir="$1"
    exitconda
    entervirtualenv
    # shellcheck disable=SC1091
    source "$venv_dir/bin/activate"
    export LIBRARY_PATH="/opt/homebrew/opt/openssl@1.1/lib"
}

_enter_virtualenv_for_montecarlo() {
    if [[ $PWD == *"/montecarlo/"* && $OLDPWD != *"/montecarlo/"* ]] ||
        [[ $PWD == *"/montecarlo/saas-serverless/"* && $OLDPWD != *"/montecarlo/saas-serverless/"* ]]; then
        if [[ -d env ]]; then
            _enter_virtualenv_dir env
        elif [[ -d venv ]]; then
            _enter_virtualenv_dir venv
        fi
    elif [[ $PWD != *"/montecarlo/"* && $OLDPWD == *"/montecarlo/"* ]] ||
        [[ $PWD != *"/montecarlo/saas-serverless/"* && $OLDPWD == *"/montecarlo/saas-serverless/"* ]]; then
        if type deactivate >/dev/null 2>&1; then
            deactivate
            exitvirtualenv
            enterconda
            unset LIBRARY_PATH
        fi
    fi
}

if [[ -n $ZSH_VERSION ]]; then
    if [[ ${chpwd_functions[*]} != *_enter_virtualenv_for_montecarlo* ]]; then
        chpwd_functions+=("_enter_virtualenv_for_montecarlo")
    fi
fi

eval "$(direnv hook zsh)"
